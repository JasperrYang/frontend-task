# Part1-2 作业

( 请在当前文件直接作答 )

## 简答题

### 1. 请说出下列最终执行结果，并解释为什么?

```javascript
var a = [];
for (var i = 0; i < 10; i++) {
  a[i] = function () {
    console.log(i);
  };
}
a[6]();
```

`10`；因为变量 `i` 是全局变量，当循环结束时 `i` 的值为`10`

### 2. 请说出此案列最终执行结果，并解释为什么?

```javascript
var tmp = 123;
if (true) {
  console.log(tmp);
  let tmp;
}
```

报错；不存在变量提升

### 3. 结合 ES6 语法，用最简单的方式找出数组中的最小值

```javascript
var arr = [12, 34, 32, 89, 4];
```

```js
Math.min.apply(this, arr);
```

### 4. 请详细说明 var、let、const 三种声明变量的方式之间的具体差别

- const 是块级作用域，定义的变量不可以修改，而且必须初始化。
  - 对于简单类型的数据，值就保存在变量指向的那个内存地址
  - 对于复合类型的数据，保存的只是一个指向实际数据的指针
- let 是块级作用域，可以修改，函数内部使用 let 定义后，对函数外部无影响。
- var 定义的是全局变量，可以修改，如果不初始化会输出 undefined，不会报错。

### 5. 请说出下列代码最终输出结果，并解释为什么？

```javascript
var a = 10;
var obj = {
  a: 20,
  fn() {
    setTimeout(() => {
      console.log(this.a);
    });
  },
};
obj.fn();
```

`20`；箭头函数中是没有自己 `this` 的，处理机制是使用自己上下文里的 `this`

### 6. 简述 Symbol 类型的用途

- 作为属性名：由于每一个 Symbol 值都是不相等的，这意味着 Symbol 值可以作为标识符，用于对象的属性名，就能保证不会出现同名的属性
- 定义常量：保证常量的值都是不相等的
- 定义类的私有属性/方法：Symbol 定义的属性是没有办法被模块外访问到的，可以达到了一个私有化的效果。

### 7. 说说什么是浅拷贝，什么是深拷贝？

- 浅拷贝只复制指向某个对象/数组的指针，而不复制对象/数组本身，新旧对象/数组还是共享同一块内存。
- 深拷贝会另外创造一个一模一样的对象/数组，新对象/数组跟原对象/数组不共享内存，修改新对象/数组不会改到原对象/数组。

### 8. 请简述 TypeScript 与 JavaScript 之间的关系？

TypeScript 是 ECMAScript 2015 的语法超集，是 JavaScript 的语法糖。JavaScript 程序可以直接移植到 TypeScript，TypeScript 需要编译（语法转换）生成 JavaScript 才能被浏览器执行。

### 9. 请谈谈你所认为的 typescript 优缺点

#### 优点

- 增加了类型系统，可以在编译阶段就发现大部分错误
- 可以编译为任意版本的 js 代码

#### 缺点

- 短期可能会增加一些开发成本，毕竟要多写一些类型的定义，不过对于一个需要长期维护的项目，TypeScript 能够减少其维护成本
- 有一定的学习成本，需要理解接口（Interfaces）、泛型（Generics）、类（Classes）、枚举类型（Enums）等前端工程师可能不是很熟悉的概念

### 10. 描述引用计数的工作原理和优缺点

#### 原理

设置引用计数器，引用关系改变时修改引用数字，当引用数字为 0 时立即回收

#### 优缺点

- 优点

  - 发现垃圾立即回收
  - 最大限度减少程序暂停（GC 时程序是阻滞的）

- 缺点
  - 无法回收循环引用的对象
  - 时间开销大（监控维护计数器）

### 11. 描述标记整理算法的工作流程

- 分为标记和清楚两个阶段。
  - 第一阶段便利所有对象标记活动对象（可达对象），在执行整理，使得空间连续
  - 第二阶段便利所有对象清楚没有被标记的对象，最后回收相应的空间。

![标记整理](https://upload-images.jianshu.io/upload_images/6010417-106015c3f724789f.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

### 12.描述 V8 中新生代存储区垃圾回收的流程

![Untitled Diagram (3).jpg](https://upload-images.jianshu.io/upload_images/6010417-1a1a495de237b912.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

#### 新生代

- 新生代指存活时间较短的对象(局部作用域等)。
- 小空间用户存储新生代对象(32M|16M)

#### 回收过程

- 回收过程采用复制算法 + 标记整理
- 新生代将内存分为两个等大小的空间
  - 使用空间为 From，空闲空间为 To
- 活动对象存储在 From 空间
- 标记整理后将活动对象拷贝至 To
- From 进行释放
- From 与 To 交换空间完成释放

**说明**：一轮 GC 后还存活的新生代需要晋升（将新生代对象移动到老生代），To 空间使用率超过 25% 也需要晋升

### 13. 描述增量标记算法在何时使用及工作原理

![增量标记算法](https://upload-images.jianshu.io/upload_images/6010417-74044c56a153c00d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

增量标记算法执行方式是程序和标记交替执行，一部分程序暂停就先执行 GC 操作，然后再执行一部分程序，再执行一部分 GC 操作，可以最大限度减少程序暂停时间，递归操作标记活动对象，标记完成后执行清除。
